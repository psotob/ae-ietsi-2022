{
  "hash": "d7ad610432955b336898832bc625f94a",
  "result": {
    "markdown": "---\ntitle: \"<img data-src='images/logo-essalud.png' height='72' width='250'/> <img data-src='images/logo-pueblo.jpg' height='72' width='250'/> <img data-src='images/logo-ietsi.png' height='72' width='250'/> <FONT color='#232429'><br>Sesión 6</FONT>\"\nsubtitle: \"<FONT color='#636363' size='7'>Programa de Formación Científica:<br>Análisis Estadístico 2022</FONT>\"\nauthor: \"<FONT color='#232429' size='30'>Percy Soto-Becerra</FONT>\"\ninstitute: \"<FONT color='#232429' size='5'>Instituto de Evaluación de Tecnologías en Salud e Investigación - IETSI, EsSalud<br>@github/psotob91</FONT>\"\ndate: \"<FONT color='#232429' size='6'>Julio 8, 2022</FONT>\"\nformat: \n  revealjs: \n    theme: default\n    footer: \"Programa de Formación Científica: Análisis Estadístico 2022 - Sesión 6\"\n    logo: images/logo-ietsi.png\n    transition: convex\n    background-transition: zoom\n    incremental: false\n    slide-number: true\n    preview-links: true\n    # parallax-background-image: images/bg-ietsi-slide-first.png\n    # parallax-background-size: \"1920px 1080px\"\n    chalkboard: true\n    code-block-background: true\n    code-block-border-left: \"#31BAE9\"\n    highlight-style: solarized\n    echo: true\n    multiplex: true\n    touch: true\n    auto-stretch: true\n    link-external-icon: true\n    link-external-newwindow: true\n---\n\n::: {.cell}\n\n:::\n\n\n## RR / RP versus OR\n\n-  RR o RP son más interpretables a nivel clínico o de Salud Pública.\n\n- Cuando el evento es frecuente, interpretar odds como probabilidades ocasiona una sobreestimación de este.\n\n- A un RR de 1.2 le puede corresponder un OR de 5. (¿cuál medida es la mejor?)\n\n## RR / RP versus OR (cont.)\n\n-  Si se interpreta apropiadamente, el OR no es malo en sí.\n\n- Es fácil de estimar de una `regresión logística`.\n\n- Sin embargo, si se desea estimar RR / RP, entonces debemos cambiar el enfoque de modelado.\n\n## ¿Cómo estimar RR / RP?\n\n-   Hay varios enfoques.\n\n- Puede derivarse RR/RP de OR obtenidos mediante regresión logística.\n\n- También podemos usar métodos de sobrevida.\n\n- Comúnmente se usa `regresión log-binomial` y `regresión de Poisson modificada`.\n\n## Modelo de regresión log-binomial\n\n- Similar estructura que `regresión logística` (modelo `logit-binomial`).\n\n- Asume que $Y_i$ sigue una distribución de bernoulli (caso particular de `binomial`).\n\n- Cambia la función de enlace `logit()` por `log()`, lo que retorna `probabilidades`, ya no `odds`. \n\n## Regresión log-binomial: Anatomía {.scrollable}\n\n**Componente sistemático:**\n\n\n$$\nlog(E(Y|x_{1i}, ..., x_{pi})) = log(E(Y_i)) = \\eta_i = \\beta_0 + \\beta_1x_{1i} + ...+ \\beta_px_{ip}\n$$\n\n\n-   $log()$ es la `función de enlace` logaritmo nepereano.\n\n-   $\\eta_i$ es el `predictor linear`.\n\n- **Función de enlace:** \n\n\n$$\\eta_i = \\beta_0 + \\beta_1x_{1i} + ...+ \\beta_px_{ip}$$\n\n\n- Podemos estimar la $Pr(y_i = 1)$ a partir del `predictor lineal`:\n\n\n$$\\pi_i = Pr(y_i = 1) = \\frac{e^{\\eta_i}}{1 + e^{\\eta_i}}$$\n\n\n- **Componente aleatorio:** \n\n\n$$y_i \\sim Bernoulli(1, \\pi_i)$$\n\n\n## La regresión log-binomial retorna RR/RP {.scrollable}\n\n- La regresión log-binomial permite retonar directamente `razón de prevalencias` (RP) o `razón de incidencias acumuladas` (RR) dependiendo del diseño.\n\n- Los coeficientes de regresión $\\beta$ del modelo son $log(RR)$ o $log(RP)$, por lo tanto, podemos exponenciarlos para obtener los RR o RR:\n\n\n$$\\beta = log(RR)$$ o \n\n$$\\beta = log(RP)$$\n\n\n<center>entonces</center>\n\n$$e^\\beta = RR$$ o \n\n$$e^\\beta = RP$$\n\n\n- Asimismo, si el modelo es correcto la inferencia (valor p e IC95%) debería ser válida.\n\n## Problemas con la regresión log-binomial {.scrollable}\n\n- Usa una función de enlace no canónica para la distibución binomial\n\n- Esto significa que no siempre se garantiza la convergencia del modelo.\n\n- Si esto ocurre, debemos optar por un modelo que sí converga: `regresión de Poisson modificada`\n\n## Modelo de regresión Poisson modificado {.scrollable}\n\n- Similar estructura que `regresión logística` (modelo `logit-binomial`).\n\n- Aunque modelo de regresión de Poisson asume que $Y_i$ sigue una distribución de Poisson, se lo `modifica` para que este supuesto no importe.\n\n- Cambia la función de enlace `logit()` por `log()`, lo que retorna `probabilidades`, ya no `odds`. \n\n## Regresión Poisson modificado: Anatomía {.scrollable}\n\n- Su estructura es la misma que el modelo de regresión de Poisson:\n\n**Componente sistemático:**\n\n\n$$\nlog(E(Y|x_{1i}, ..., x_{pi})) = log(E(Y_i)) = \\eta_i = \\beta_0 + \\beta_1x_{1i} + ...+ \\beta_px_{ip}\n$$\n\n\n-   $log()$ es la `función de enlace` logaritmo nepereano.\n\n-   $\\eta_i$ es el `predictor linear`.\n\n- **Función de enlace:** \n\n\n$$\\eta_i = \\beta_0 + \\beta_1x_{1i} + ...+ \\beta_px_{ip}$$\n\n\n- Podemos estimar la $Pr(y_i = 1)$ a partir del `predictor lineal`:\n\n\n$$\\pi_i = Pr(y_i = 1) = \\frac{e^{\\eta_i}}{1 + e^{\\eta_i}}$$\n\n\n- **Componente aleatorio:** \n\n\n$$y_i \\sim Poisson(\\lambda = \\pi_i)$$\n\n\n- **Modificación del modelo**: \n\n    + Para estimar apropiadamente la varianza de los $\\beta$ y tener inferencias válidas (valor p e IC95% apropiados), el modelo aplica una estimación robusta de varianza tipo sandwich.\n\n## La regresión de Poisson también retorna RR/RP\n\n- La regresión de Poisson permite retonar directamente `razón de prevalencias` (RP) o `razón de incidencias acumuladas` (RR) dependiendo del diseño.\n\n- Los coeficientes de regresión $\\beta$ del modelo son $log(RR)$ o $log(RP)$, por lo tanto, podemos exponenciarlos para obtener los RR o RR:\n\n\n$$\\beta = log(RR)$$ o \n\n$$\\beta = log(RP)$$\n\n\n<center>entonces</center>\n\n$$e^\\beta = RR$$ o \n\n$$e^\\beta = RP$$\n\n\n- sin embargo, si el modelo es correcto la inferencia no es válida salvo que se corrija la varianza.\n\n    + Ajuste robusto de varianza es opción más usada.\n\n## Casos aplicados {.scrollable}\n\n- Identificar factores asociados a que el niño tenga alergia.\n\n\n::: panel-tabset\n\n### Ejemplo 1\n\n- Factores asociados a desarrollo de alergia en niños.\n\n- Especificación del modelo \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- glm(allergyc ~ smokem + smokef + allergym + allergyf, \n           family = poisson(link = \"log\"), \n           data = datos_allergy)\nsummary(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = allergyc ~ smokem + smokef + allergym + allergyf, \n    family = poisson(link = \"log\"), data = datos_allergy)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.0643  -0.8186  -0.6807   0.7641   1.3707  \n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  -1.7689     0.1247 -14.181  < 2e-16 ***\nsmokem        0.3181     0.1217   2.613  0.00899 ** \nsmokef        0.3687     0.1178   3.130  0.00175 ** \nallergym      0.3066     0.1146   2.674  0.00749 ** \nallergyf      0.2070     0.1096   1.888  0.05904 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 815.58  on 1124  degrees of freedom\nResidual deviance: 782.50  on 1120  degrees of freedom\nAIC: 1482.5\n\nNumber of Fisher Scoring iterations: 5\n```\n:::\n:::\n\n\n- Presentación con intervalos de confianza y exponenciada (RR): \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(sandwich)\nmod %>% \n  tidy(conf.int = TRUE, exponentiate = TRUE, vcov = sandwich) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 7\n  term        estimate std.error statistic  p.value conf.low conf.high\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>\n1 (Intercept)    0.171     0.125    -14.2  1.21e-45    0.133     0.217\n2 smokem         1.37      0.122      2.61 8.99e- 3    1.08      1.75 \n3 smokef         1.45      0.118      3.13 1.75e- 3    1.15      1.82 \n4 allergym       1.36      0.115      2.67 7.49e- 3    1.08      1.70 \n5 allergyf       1.23      0.110      1.89 5.90e- 2    0.991     1.52 \n```\n:::\n:::\n\n\n- Interpretación:\n\n    + `smokem`: El riesgo de desarrollar alergia en niños de madres fumadoras es 1.37 veces el de niños de madres no fumadoras, controlando por antecedente de fumar de padre, alergia de madre y alergia de padre (RR = 1.37; IC95% 1.08 a 1.75; p < 0.001).\n    \n    + `smokef`: El riesgo de desarrollar alergia en niños de papás fumadoras es 1.45 veces el de niños de papás no fumadoras, controlando por antecedente de fumar de madre, alergia de madre y alergia de padre (RR = 1.45; IC95% 1.15 a 1.82; p = 0.009).\n    \n    + `allergym`: El riesgo de desarrollar alergia en niños de madres con alergias es 1.36 veces el de niños de madres sin alergia, controlando por antecedente de fumar de madre, antecedente de fumar del papá,  y alergia del papá (RR = 1.36; IC95% 1.08 a 1.70; p = 0.007).\n    \n    + `allergyf`: El riesgo de desarrollar alergia en niños de papás con alergias es 1.23 veces el de niños de papás sin alergia, controlando por antecedente de fumar de madre, antecedente de fumar del papá,  y alergia de la madre (RR = 1.23; IC95% 0.99 a 1.52; p = 0.059).\n\n::: callout-note\n\n### Supuestos\n\n- Linealidad del $logit(y_i = 1)$ respecto a los predictores.\n\n- Observaciones son independientes.\n\n- $Y_i$ sigue distribución de bernoulli.\n\n- No problemas de regresión:\n\n    + No puntos influyentes\n    \n    + No colinealidad: Solo cuando esta es un problema. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_model(mod)\n```\n\n::: {.cell-output-display}\n![](Sesion-6_files/figure-revealjs/unnamed-chunk-4-1.png){width=960}\n:::\n:::\n\n\n:::\n\n### Ejemplo 2\n\n- Factores asociados a tener lumbalgia a 5 años de seguimeinto.\n\n- Especificación del modelo \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod <- glm(bp5 ~ bp0 + sex + age + phyocc + social, \n           family = poisson(link = \"log\"), \n           data = datos_backpain)\nsummary(mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = bp5 ~ bp0 + sex + age + phyocc + social, family = poisson(link = \"log\"), \n    data = datos_backpain)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-0.7792  -0.6056  -0.5246  -0.4424   1.7811  \n\nCoefficients:\n                     Estimate Std. Error z value Pr(>|z|)    \n(Intercept)         -2.381838   0.606973  -3.924  8.7e-05 ***\nbp0                 -0.064393   0.189777  -0.339   0.7344    \nsexfemale            0.313311   0.151318   2.071   0.0384 *  \nage                  0.010589   0.013120   0.807   0.4196    \nphyocc2 - low       -0.397751   0.288867  -1.377   0.1685    \nphyocc3 - moderate  -0.025682   0.258255  -0.099   0.9208    \nphyocc4 - heavy      0.357670   0.283432   1.262   0.2070    \nsocialself employed -0.213537   0.214439  -0.996   0.3194    \nsocialwhite collar  -0.009969   0.192679  -0.052   0.9587    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 661.07  on 1123  degrees of freedom\nResidual deviance: 644.08  on 1115  degrees of freedom\n  (195 observations deleted due to missingness)\nAIC: 1024.1\n\nNumber of Fisher Scoring iterations: 6\n```\n:::\n:::\n\n\n- Presentación con intervalos de confianza y exponenciada (RP): \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nmod %>% \n  tidy(conf.int = TRUE, exponentiate = TRUE, vcov = sandwich) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 9 × 7\n  term                estimate std.error statistic   p.value conf.low conf.high\n  <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl>\n1 (Intercept)           0.0924    0.607    -3.92   0.0000870   0.0276     0.299\n2 bp0                   0.938     0.190    -0.339  0.734       0.637      1.34 \n3 sexfemale             1.37      0.151     2.07   0.0384      1.02       1.85 \n4 age                   1.01      0.0131    0.807  0.420       0.985      1.04 \n5 phyocc2 - low         0.672     0.289    -1.38   0.169       0.383      1.20 \n6 phyocc3 - moderate    0.975     0.258    -0.0994 0.921       0.598      1.65 \n7 phyocc4 - heavy       1.43      0.283     1.26   0.207       0.832      2.54 \n8 socialself employed   0.808     0.214    -0.996  0.319       0.523      1.22 \n9 socialwhite collar    0.990     0.193    -0.0517 0.959       0.678      1.44 \n```\n:::\n:::\n\n\n- Interpretación:\n\n    + `bp0`: La prevalencia de tener dolor lumbar crónico en quienes reportaron antecedente de lumbalgia  fue 6% menor que en quienes negaron antecedente de lumbalgia, luego de controlar por sexo, edad, nivel de actividad física y estatus social. Sin embargo, no se cuenta con suficiente evidencia estadística para concluir que la asociación exista en la población debido a la gran imprecisión de la estimación (RP = 0.94; 95%CI 0.64 a 1.34, p = 0.734). \n    \n    + `sex`: La prevalencia de tener dolor lumbar crónica en mujeres fue 1.37 veces el de varones, luego de controlar por antecedente de lumbalgia, edad, nivel de actividad física y estatus social (RP = 1.37; 95%CI 1.02 a 1.85; p = 0.038).\n    \n    + `age`: El aumento en un año de edad se asocia a un aumento de 1.1% de la prevalencia de tener dolor lumbar crónico, luego de controlar por sexo, antecedente de lumbalgia, nivel de actividad física y estatus social (RP = 1.01; 95%CI 0.99 a 1.04; p = 0.420). Teniendo en cuenta la incertidumbre de la estimación, no podemos afirmar si esta relación existe en la población. \n    \n    + `phyocc - low`: La prevalencia de tener dolor lumbar crónico en quienes reportan niveles bajos de actividad física es 33% menor que en quienes reportan niveles de actividad física muy bajos, luego de controlar por sexo, antecedente de lumbalgia, edad y estatus social (RP = 0.38; 95%CI 0.34 a 1.20; p = 0.169). La gran varibabilidad muestral previene que podamos afirmar la existencia de una relación en la población.\n    \n    + `phyocc - moderate`: La prevalencia de tener dolor lumbar crónico en quienes reportan niveles moderados de actividad física es 3% menor que en quienes reportan niveles de actividad física muy bajos, luego de controlar por sexo, antecedente de lumbalgia, edad y estatus social (RP = 0.97; 95%CI 0.60 a 1.65; p = 0.921). Teniendo en cuenta la incertidumbre de la estimación, no podemos afirmar si esta relación existe en la población. \n    \n    + `phyocc - heavy`: La prevalencia de tener dolor lumbar crónico en quienes reportan niveles intensos de actividad física es 1.43 veces mayor que en quienes reportan niveles de actividad física muy bajos, luego de controlar por sexo, antecedente de lumbalgia, edad y estatus social (RP = 1.43; 95%CI 0.83 a 2.54; p = 0.207). Teniendo en cuenta la incertidumbre de la estimación, no podemos afirmar si esta relación existe en la población. \n    \n    + `socialself employed`: [completar]\n    \n    + `socialwhite collar`: [completar]\n\n::: callout-note\n\n### Supuestos\n\n- Linealidad del $logit(y_i = 1)$ respecto a los predictores.\n\n- Observaciones son independientes.\n\n- $Y_i$ sigue distribución de bernoulli.\n\n- No problemas de regresión:\n\n    + No puntos influyentes\n    \n    + No colinealidad: Solo cuando esta es un problema. \n    \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_model(mod)\n```\n\n::: {.cell-output-display}\n![](Sesion-6_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n \n\n:::\n\n\n:::\n\n## \n\n::: r-fit-text\n<br>\n\n<center>\n\nslides:\n\n</center>\n\n<center>\n\n[https://bit.ly/3n6Ejzb](https://ietsi-academy-aed.netlify.app/sesiones/sesion-1/sesion-1c)\n\n</center>\n:::\n\n## \n\n::: r-fit-text\n<center>**¡Gracias por su atención!**</center>\n\n<center>**¡Encantado de responder sus consultas!**</center>\n\n<br>\n\n<center>**Percy Soto-Becerra**</center>\n\n<br>\n\n<center><svg viewBox=\"0 0 512 512\" style=\"height:1em;position:relative;display:inline-block;top:.1em;\" xmlns=\"http://www.w3.org/2000/svg\">  <path d=\"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z\"></path></svg> <svg viewBox=\"0 0 496 512\" style=\"height:1em;position:relative;display:inline-block;top:.1em;\" xmlns=\"http://www.w3.org/2000/svg\">  <path d=\"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z\"></path></svg> @psotob91</center>\n\n<center><svg viewBox=\"0 0 576 512\" style=\"height:1em;position:relative;display:inline-block;top:.1em;\" xmlns=\"http://www.w3.org/2000/svg\">  <path d=\"M567.938 243.908L462.25 85.374A48.003 48.003 0 0 0 422.311 64H153.689a48 48 0 0 0-39.938 21.374L8.062 243.908A47.994 47.994 0 0 0 0 270.533V400c0 26.51 21.49 48 48 48h480c26.51 0 48-21.49 48-48V270.533a47.994 47.994 0 0 0-8.062-26.625zM162.252 128h251.497l85.333 128H376l-32 64H232l-32-64H76.918l85.334-128z\"></path></svg> **percys1991\\@gmail.com**</center>\n:::\n\n::: aside\n<br> <FONT size='4'>Presentación creada vía `Revealjs` en `Quarto` en `RStudio`.</FONT>\n:::\n",
    "supporting": [
      "Sesion-6_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\r\n<script>\r\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\r\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\r\n  // slide changes (different for each slide format).\r\n  (function () {\r\n    function fireSlideChanged(previousSlide, currentSlide) {\r\n\r\n      // dispatch for htmlwidgets\r\n      const event = window.document.createEvent(\"Event\");\r\n      event.initEvent(\"slideenter\", true, true);\r\n      window.document.dispatchEvent(event);\r\n\r\n      // dispatch for shiny\r\n      if (window.jQuery) {\r\n        if (previousSlide) {\r\n          window.jQuery(previousSlide).trigger(\"hidden\");\r\n        }\r\n        if (currentSlide) {\r\n          window.jQuery(currentSlide).trigger(\"shown\");\r\n        }\r\n      }\r\n    }\r\n\r\n    // hookup for reveal\r\n    if (window.Reveal) {\r\n      window.Reveal.addEventListener(\"slidechanged\", function(event) {\r\n        fireSlideChanged(event.previousSlide, event.currentSlide);\r\n      });\r\n    }\r\n\r\n    // hookup for slidy\r\n    if (window.w3c_slidy) {\r\n      window.w3c_slidy.add_observer(function (slide_num) {\r\n        // slide_num starts at position 1\r\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\r\n      });\r\n    }\r\n\r\n  })();\r\n</script>\r\n\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}